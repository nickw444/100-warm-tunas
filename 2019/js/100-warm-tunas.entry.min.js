!function(){"use strict";var n=function(e){var t=document.getElementById("player");t.classList.remove("hidden"),document.body.classList.add("hasPlayer"),t.setAttribute("src",e),t.play(),t.onended=function(){return t.classList.add("hidden")}};function e(){var t=document.querySelector(".header__spotify");if(null!=t){var n=new IntersectionObserver(function(e){e[0].isIntersecting&&(function(e){console.log("Loading spotify embed");var t=document.createElement("iframe");t.src=e.dataset.spotifyEmbedUrl,t.width=t.height=300,t.classList.add("header__spotifyEmbed"),t.title="Spotify Embed",t.onload=function(){t.classList.add("header__spotifyEmbed--loaded")},e.appendChild(t)}(t),n.disconnect())});n.observe(t)}}var r=window.requestIdleCallback||function(e){return window.setTimeout(e,50)};document.addEventListener("DOMContentLoaded",function(){var a,o,t;document.querySelectorAll(".result__listenButton").forEach(function(e){e.addEventListener("click",function(){n(e.dataset.previewSrc),ga("send","event",{eventCategory:"listen",eventAction:"click",dimension1:e.dataset.previewSrc,dimension2:e.dataset.songId})})}),a=new Set,o=new Set,t=new IntersectionObserver(function(e){e.forEach(function(t){var n=t.target.dataset.src,r=t.target.dataset.alt;t.isIntersecting?(a.has(n)&&console.error("Already loading",n),a.add(n),t.target.classList.add("result__artworkPlaceholder--loading"),window.setTimeout(function(){if(a.has(n)){if(o.has(n))return;o.add(n);var e=new Image;e.src=n,e.alt=r,e.classList.add("result__artworkImage","result__artworkImage--fadein"),e.onload=function(){t.target.parentNode.insertBefore(e,t.target),t.target.remove()},e.onerror=function(){t.target.classList.remove("result__artworkPlaceholder--loading")}}},200)):a.delete(n)})},{rootMargin:"48px"}),document.querySelectorAll(".result__artworkPlaceholder").forEach(function(e){return t.observe(e)}),e(),r(function(){return particlesJS.load("particles-js","particlesjs-config.json")})})}();
